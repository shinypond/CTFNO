# Tackling the Limitation of Neural ODEs through Partial Differential Equations (CTFNO)
![Python 3.9](https://img.shields.io/badge/python-3.9-red.svg)
![PyTorch 1.11.0](https://img.shields.io/badge/pytorch-1.11.0-blue.svg)

## Setup
0. Change CUDA version in environment.yml to yours
1. Create conda environment: `conda create -n ctfno python=3.9`
2. Activate: `conda activate ctfno`
3. Install dependencies: `conda env update -f requirements.yml --prune`

## Download dataset
- The datasets for heat, Burgers', Reaction ODE equation, Plane Vibration and ScalarFlow (2D) can be downloaded at [this LINK][dataset].
    - The datasets for heat, Burgers', Reaction ODE equation were synthesized numerically.
    - ScalarFlow (2D) was generated by averaging the original [ScalarFlow density dataset][scalarflow] (3D) along the depth axis.
- The datasets for Mujoco Hopper and PhysioNet are downloaded and processed when `main.py` is run for the first time.
    - Raw datasets : [MuJoCo][hopper], [PhysioNet][physionet]
- Each dataset should be placed in `data/[data_name]/`.

## Run
- Heat equation
    - Models: `ctfno`, `nf`, `node`, `fnoseq`, `fno2d`
```
python main.py --data heat --model ctfno --exp-name test
```
- Burgers' equation
    - Models: `ctfno`, `nf`, `node`, `fnoseq`, `fno2d`
```
python main.py --data burgers --model ctfno --exp-name test
```
- Reaction ODE equation
    - Models: `ctfno`, `nf`, `node`
```
python main.py --data ode --model ctfno --exp-name test
```
- Plane Vibration 
    - Models: `ctfno`
```
python main.py --data pv --model ctfno --exp-name test
```
- ScalarFlow
    - Models: `ctfno`, `anode`
```
python main.py --data scalarflow --model ctfno --exp-name test
```
- MuJoCo (Hopper)
    - Models: `ctfno`, `nf`, `lode`
    - Encoders: `rnn`, `nfrnn` (only for `nf`), `odernn` (only for `lode`)
```
python main.py --data hopper --model ctfno --encoder rnn --exp-name test
```
- PhysioNet
    - Models: `ctfno`, `nf`, `lode`
    - Encoders: `rnn`
```
python main.py --data physionet --model ctfno --encoder rnn --exp-name test
```

## License
All materials are provided under the MIT license.<br>
The (synthesized) datasets for heat equation, Burgers' equation and reaction ODE equation are provided under the MIT license.


[dataset]: https://drive.google.com/drive/u/1/folders/11G91B3QFT3v16pkAacFDQVCHR0DuJRD1 
[scalarflow]: https://ge.in.tum.de/publications/2019-scalarflow-eckert/
[hopper]: https://www.cs.toronto.edu/~rtqichen/datasets/HopperPhysics/training.pt
[physionet]: https://physionet.org/physiobank/database/challenge/2012/
[latentode]: https://github.com/YuliaRubanova/latent_ode
[stribor]: https://github.com/mbilos/stribor
